# 🚗 Lead Generation Prediction for Vehicle Listings

## 🎯 Project Overview
This machine learning project predicts the number of leads generated by vehicle advertisements using advanced feature engineering and gradient boosting algorithms. The solution helps automotive businesses optimize their listing strategies and maximize customer engagement through data-driven insights.

**Main Goal**: Predict the number of leads (customer inquiries) that a vehicle listing will generate based on vehicle characteristics, pricing, location, and advertisement features.

## 🏆 Model Performance & Results

### **Key Achievements**
- **📊 Model Accuracy**: RMSE = 6.922 leads, R² = 70.3%
- **📈 Performance Improvement**: 64.6% better than baseline prediction
- **⚡ Processing Speed**: <1ms prediction time per listing
- **📋 Feature Optimization**: Reduced from 48 to 16 features while maintaining accuracy

### **Model Specifications**
- **Algorithm**: LightGBM Regressor with hyperparameter optimization
- **Training Data**: 48,578 vehicle listings
- **Validation**: 5-fold cross-validation with overfitting detection
- **Feature Engineering**: Target encoding, flag clustering, and outlier removal

### **Business Impact Categories**
The model predictions are categorized into actionable business ranges:

| Lead Range | Category | Business Action | Expected ROI |
|------------|----------|-----------------|--------------|
| 0-5 leads | 🔴 **Low Performance** | Review listing quality, adjust pricing | Focus on optimization |
| 6-15 leads | 🟡 **Moderate Performance** | Standard monitoring, minor adjustments | Maintain current strategy |
| 16-30 leads | 🟢 **High Performance** | Replicate success factors, scale strategy | Increase investment |
| 31+ leads | 🌟 **Exceptional Performance** | Case study analysis, premium placement | Maximum investment |

## 🔍 What Was Accomplished

### **1. Data Analysis & Cleaning**
- Analyzed 48,578 vehicle listings across multiple states and cities
- Cleaned and processed 48 initial features down to 16 optimized features
- Removed outliers and handled missing values systematically

### **2. Advanced Feature Engineering**
- **Geographic Encoding**: City and state target encoding with overfitting prevention
- **Flag Clustering**: Grouped vehicle features into meaningful clusters using Jenks Natural Breaks
- **Price Optimization**: Market value vs. advertised price relationship analysis
- **Visual Impact**: Photo count optimization (8 photos = optimal performance)

### **3. Model Development**
- **Hyperparameter Optimization**: 150 Optuna trials for optimal performance
- **Overfitting Prevention**: Learning curve analysis and regularization
- **Production Pipeline**: Sklearn-compatible pipeline for easy deployment

### **4. Business Intelligence**
- **Key Drivers Identified**: Phone clicks, views, geographic location, price positioning
- **Performance Patterns**: State-specific lead generation analysis
- **ROI Optimization**: Feature importance ranking for advertisement improvement

## 🚀 Real-World Business Application

### **For Automotive Dealers**
```python
# Example prediction for a new listing
new_listing = {
    'phone_clicks': 12,
    'views': 150, 
    'city': 'São Paulo',
    'state': 'SP',
    'vl_advertise': 45000,
    'n_photos': 8,
    'vehicle_brand': 'Toyota'
}

predicted_leads = model.predict(new_listing)
# Output: 18 leads (🟢 High Performance category)
```

### **Business Workflow Integration**
1. **📝 Listing Creation**: Input vehicle and advertisement details
2. **🔮 Lead Prediction**: Get instant lead forecast with confidence intervals
3. **📊 Category Classification**: Automatic classification into performance ranges
4. **💡 Optimization Suggestions**: Actionable recommendations for improvement
5. **📈 Performance Tracking**: Monitor actual vs. predicted performance

### **Decision Support System**
- **Inventory Management**: Prioritize high-potential vehicles for premium placement
- **Pricing Strategy**: Optimize price points based on lead generation potential
- **Geographic Focus**: Allocate marketing budget to high-performing regions
- **Content Optimization**: Adjust photo count and description based on predictions

## 📊 Key Success Factors Identified

### **Top Lead Generation Drivers**
1. **📞 Phone Engagement** (Highest Impact)
   - Direct correlation with serious buyer intent
   - Recommendation: Optimize for phone click generation

2. **👁️ Visual Presentation** (High Impact)
   - 8 photos = optimal performance
   - Quality over quantity in image selection

3. **🌍 Geographic Location** (High Impact)
   - State-specific performance variations
   - City-level optimization opportunities

4. **💰 Price Positioning** (Medium-High Impact)
   - Sweet spot relative to market value
   - Competitive pricing analysis essential

5. **🚗 Vehicle Features** (Medium Impact)
   - Safety and comfort feature clusters
   - Premium features drive engagement



## 🛠️ Technical Implementation

### **Quick Start for Business Users**
```bash
# 1. Setup environment
git clone <repository-url>
cd leads-analysis-prediction
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 2. Install dependencies
pip install -r requirements.txt

# 3. Load trained model and make predictions
python -c "
import joblib
import pandas as pd

# Load pre-trained model
model = joblib.load('models/complete_ml_pipeline.joblib')

# Example prediction
new_listing = pd.DataFrame({
    'views': [150], 'phone_clicks': [12], 'city': ['São Paulo'],
    'state': ['SP'], 'vl_advertise': [45000], 'n_photos': [8],
    'cd_vehicle_brand': ['Toyota'], 'year_model': [2020]
})

leads_prediction = model.predict(new_listing)[0]
print(f'Predicted leads: {leads_prediction:.0f}')
"
```

### **Model Integration Options**

#### **Option 1: Batch Prediction (Recommended for most users)**
```python
from src.models.model_trainer import ModelTrainer
import pandas as pd

# Load your vehicle listings
listings_df = pd.read_csv('your_listings.csv')

# Get predictions for all listings
trainer = ModelTrainer()
predictions = trainer.predict_batch(listings_df)

# Add predictions to your data
listings_df['predicted_leads'] = predictions
listings_df['performance_category'] = pd.cut(
    predictions, 
    bins=[0, 5, 15, 30, float('inf')], 
    labels=['Low', 'Moderate', 'High', 'Exceptional']
)
```

#### **Option 2: Real-time API Integration**
```python
from src.models.model_trainer import ModelTrainer
from flask import Flask, request, jsonify

app = Flask(__name__)
model = ModelTrainer.load_model('complete_ml_pipeline')

@app.route('/predict', methods=['POST'])
def predict_leads():
    data = request.json
    prediction = model.predict_single(data)
    category = categorize_prediction(prediction)
    
    return jsonify({
        'predicted_leads': prediction,
        'category': category,
        'recommendations': get_recommendations(prediction, data)
    })
```

## 📈 Business Value & ROI

### **Quantified Benefits**
- **🎯 Accuracy**: 70% of lead variance explained by model
- **⏱️ Speed**: Instant predictions vs. weeks of waiting for results
- **💰 Cost Reduction**: Optimize ad spend based on predicted performance
- **📊 Data-Driven**: Replace guesswork with statistical predictions

### **Use Cases by Business Size**

#### **🏢 Large Dealerships (1000+ listings/month)**
- **Inventory Prioritization**: Focus premium placement on high-prediction vehicles
- **Dynamic Pricing**: Adjust prices based on lead generation potential
- **Geographic Expansion**: Identify promising new markets
- **Performance Benchmarking**: Set realistic lead targets by category

#### **🏪 Medium Dealerships (100-1000 listings/month)**
- **Listing Optimization**: Improve photo count and description quality
- **Market Positioning**: Understand competitive advantages
- **Resource Allocation**: Focus effort on high-potential listings
- **Performance Tracking**: Monitor actual vs. predicted results

#### **🚗 Independent Sellers (<100 listings/month)**
- **Listing Quality**: Get instant feedback on listing effectiveness
- **Price Optimization**: Find the sweet spot for lead generation
- **Best Practices**: Learn from high-performing listing patterns
- **Market Insights**: Understand local market dynamics

## 📁 Project Structure

```
├── README.md              # Project overview and model results
├── requirements.txt       # Python dependencies
├── setup.py               # Package configuration
│
├── config/               # Configuration files
│   └── config.yaml       # Model and data configurations
│
├── data/                 # Data pipeline
│   ├── raw/              # Original vehicle listing data
│   ├── processed/        # Cleaned data ready for modeling
│   └── external/         # Additional data sources
│
├── models/               # Trained models
│   ├── complete_ml_pipeline.joblib    # Production-ready model
│   └── *.pkl             # Model artifacts and transformers
│
├── notebooks/            # Analysis and development
│   ├── exploratory/      # Data exploration and insights
│   ├── feature_engineering/ # Feature development process
│   ├── modeling/         # Model training and evaluation
│   ├── feature_eng_report.md # Feature engineering documentation
│   └── modeling_report.md    # Model performance analysis
│
├── src/                  # Production code
│   ├── data/             # Data loading and processing
│   ├── features/         # Feature engineering pipeline
│   ├── models/           # Model training and prediction
│   └── visualization/    # Business reporting and charts
│
└── tests/                # Quality assurance
    └── test_*.py         # Unit tests for all components
```

## 🔬 Technical Deep Dive (For Data Scientists)

### **Model Architecture**
- **Base Algorithm**: LightGBM Regressor
- **Feature Engineering**: Target encoding + flag clustering + outlier removal
- **Optimization**: Optuna hyperparameter tuning (150 trials)
- **Validation**: 5-fold cross-validation with overfitting detection

### **Key Technical Achievements**
- **Feature Reduction**: 48 → 16 features (67% reduction) with no accuracy loss
- **Encoding Innovation**: Target encoding with smoothing for high-cardinality features
- **Flag Clustering**: Jenks Natural Breaks for vehicle feature combinations
- **Production Pipeline**: Sklearn-compatible for seamless deployment

### **Performance Metrics**
```
Test Set Results:
├── RMSE: 6.922 leads
├── R²: 0.703 (70.3% variance explained)
├── MSE: 47.912
└── Baseline Improvement: 64.6%

Cross-Validation:
├── 5-fold CV stability
├── Overfitting detection: 35.4% gap
└── Recommendation: Regularization for production
```

## 🚀 Getting Started

### **For Business Users (Non-Technical)**
1. **Contact your IT team** to set up the model environment
2. **Provide your vehicle listing data** in CSV format
3. **Receive predictions** categorized by performance level
4. **Implement recommendations** based on prediction categories

### **For Developers/Data Scientists**

#### **Quick Setup**
```bash
# Clone and setup
git clone <repository-url>
cd leads-analysis-prediction
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# Run example prediction
python notebooks/modeling/01_model.ipynb
```

#### **Model Training from Scratch**
```python
# 1. Load and preprocess data
from src.data.data_loader import load_raw_data
from src.features.feature_engineering import PreprocessingFeaturesTransformer

raw_data = load_raw_data('data/raw/raw_data.csv')
preprocessor = PreprocessingFeaturesTransformer()
clean_data = preprocessor.fit_transform(raw_data)

# 2. Train model with optimization
from src.models.model_trainer import ModelTrainer
import optuna

trainer = ModelTrainer()
study = optuna.create_study(direction='minimize')
study.optimize(trainer.objective, n_trials=150)

# 3. Evaluate and save
model = trainer.train_best_model(study.best_params)
trainer.save_model(model, 'models/complete_ml_pipeline.joblib')
```

## 📚 Documentation & Reports

### **Business Reports**
- **📊 [Modeling Report](notebooks/modeling_report.md)**: Complete model performance analysis
- **⚙️ [Feature Engineering Report](notebooks/feature_eng_report.md)**: Feature development process
- **📈 [Exploratory Analysis](notebooks/exploratory/)**: Data insights and patterns

### **Technical Documentation**
- **🔧 API Documentation**: Model integration guidelines
- **📝 Notebooks**: Step-by-step analysis process
- **🧪 Tests**: Quality assurance and validation

## 🎯 Next Steps & Roadmap

### **Phase 1: Immediate Implementation** (0-3 months)
- Deploy model for batch predictions
- Implement performance monitoring dashboard
- A/B testing for model-driven decisions

### **Phase 2: Enhancement** (3-6 months)
- Real-time prediction API
- Geographic expansion analysis
- Advanced feature engineering

### **Phase 3: Advanced Analytics** (6-12 months)
- Multi-target modeling (leads + conversion rate)
- Deep learning exploration
- Automated retraining pipeline

## 🤝 Support & Contact

### **Business Inquiries**
- Model implementation consultation
- Custom analysis requests
- Performance optimization

### **Technical Support**
- Integration assistance
- Model retraining guidance
- Custom feature development

---

**📧 Contact**: Angelo Pelisson  
**🔗 Repository**: [leads-analysis-prediction](https://github.com/AngeloPelisson95/leads-analysis-prediction)  
**📊 Model Performance**: RMSE 6.922 | R² 70.3% | 64.6% improvement over baseline

---

*This project demonstrates the practical application of machine learning in automotive business optimization, providing actionable insights through predictive analytics.*
